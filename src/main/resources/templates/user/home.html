<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">

<head th:replace="component/head :: head">
	<style>
		#myChart {
			background-color: #ccc;
		}
	</style>
</head>

<body onload="getUsingState()">
	<header th:replace="component/header :: header"></header>

	<!-- Begin page content -->
	<div class="container">
		<div class="row">
			<div th:replace="component/sidebar"></div>

			<div class="col-md-8">				
				<h2 style="margin-left: 13%">
					<span>欢迎用户：</span>
					<span id="username" th:text="${userName}"></span>
				</h2>
				<br>
				<div class="row col-md-10 offset-md-1">
					<div class="col-md-12">
						<div class="card">
							<div class="card-body">
								<p class="card-text">根据正常课表安排以及临时教室的申请，整理出了如下的教室申请的饼图，可供信息参考：</p>
								<p class="card-text">
									<small class="text-muted">最近一次更新在3分钟前</small>
								</p>
							</div>
							<canvas id="myChart" style="background-color: #f4f4f4;">
							        图表区
						    </canvas>
						
						    
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End page content -->

	<footer th:replace="component/footer :: footer"></footer>
	
	<script th:inline="javascript">
	
		function getUsingState() {
			//获取教室使用情况数据
			$.ajax({
				url: "/genesis/reststatical/get-classroom-using-state",
				type: "POST",
				contentType: "application/json; charset=utf-8",
				dataType: 'json',
				async: false,
				success: function (result) {
					var map = result;
					used = result['used'];
					unused = result['unused'];
					(function () {
			            'use strict';			         
			            var type = 'pie'; //圆饼图
			            var data = {
			                labels: ['已占用教室', '未占用教室'],
			                datasets: [
			                    {
			                        data: [used, unused],
			                        backgroundColor: ['lightcoral', 'aquamarine'],
			                        borderWidth: 1
			                    }
			                ]
			            };
			            var options = {
			                title: { //标题
			                    display: true,
			                    text: '教室使用情况',
			                    fontColor: '#969696',
			                    fontSize: '48'
			                },
			                legend: { //图例
			                    position: 'right',
			                    diaplay: true,
			                    labels: { //图例标签
									boxWidth: 18,
									fontSize: 18,
									padding: 18
								},
			                },
			                layout: { //填充，改变位置
			                    padding: {
			                        left: 20,
			                        right: 60,
			                        top: 20,
			                        bottom: 30
			                    }
			                }
			            };

			            var ctx = document.getElementById('myChart').getContext('2d');
			            var chart = new Chart(ctx, {
			                type: type,
			                data: data,
			                options: options
			            });
			        })();
					
				},
				error: function (e) {
					alert("getUsingState异常");
				}
			});
		}	
		
        
    
	</script>
	
	<div th:replace="component/footer-lib"></div>
</body>

</html>